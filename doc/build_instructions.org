* ------------------------------------------------------------------------------
* installation under spack - hints
- do the mu2e spack thing - see https://github.com/Mu2e/daq-operations/wiki/Getting-Started-With-Spack
- cd to the top/spack-repos
- git clone https://github.com/pavel1murat/spack_packages murat-spack
  spack repo add murat-spack

  # keep using gcc 13.1.0 , problems otherwoise

  spack env create midas
  spack env activate midas

  spack add root@6.30.06%gcc@13.1.0+postgres+root7+webgui cxxstd=20
  spack add art-root-io@1.13.06%gcc@13.1.0 cxxstd=20
  
  spack concretize -f
  spack install 

  spack add otsdaq-mu2e-tracker@develop%gcc@13.1.0
  spack add midas@develop%gcc@13.1.0~postgresql~sqlite~opencv
  spack add tfm@main%gcc@13.1.0
  spack add frontends@main%gcc@13.1.0
  
  spack develop frontends@main%gcc@13.1.0
  spack develop tfm@main%gcc@13.1.0
  spack develop midas@develop%gcc@13.1.0~postgresql~sqlite~opencv
  spack develop otsdaq-mu2e-tracker@develop%gcc@13.1.0
  
  spack add     emacs@29.3%gcc@13.1.0+X toolkit=athena
  spack add     cairo+X+fc+ft
  
  spack concretize -f
  spack install
* ROOT interface to mu2e_pcie_utils    validated <2023-07-19 Wed>            
- If you got here, you already have built the OTS libraries
- ROOT interface library is not available by default, you have to build it
#+begin_src
cd srcs
git clone https://github.com/mu2e/mu2e_pcie_utils
cd mu2e_pcie_utils
git checkout pasha
cd ../..
export BUILD_ROOT_INTERFACE=1
mrb b
#+end_src
after that, you can do the following:
#+begin_src
root.exe
root [0] DTCLib::DTC dtc(DTCLib::DTC_SimMode_NoCFO,-1,0x1,"");
06-18 17:41:07.271940                      DTC_Registers     INFO DTC_Registers(...): Sim Mode is NoCFO
06-18 17:41:07.271997                      DTC_Registers     INFO DTC_Registers(...): DTC ID is 1
06-18 17:41:07.272011                      DTC_Registers     INFO SetSimMode(...): Initializing device, sim mode is NoCFO
06-18 17:41:07.278490                      DTC_Registers     INFO SetSimMode(...): SKIPPING Initializing device
06-18 17:41:07.283713                            DTC.cpp     INFO DTC(...): CONSTRUCTOR
root [1] mu2edev* dev = dtc.GetDevice();
root [2]   uint32_t res; 
root [3]   int      rc;
root [4]   rc = dev->read_register(0x9100,100,&res); printf("0x9100: DTC status       : 0x%08x\n",res); // expect: 0x40808404
0x9100: DTC status       : 0x40808404
#+end_src

*Comments*

- for examples, see https://github.com/Mu2e/otsdaq_mu2e_tracker/blob/pasha/scripts/test_buffer_async.C , 
  or any other .C script in that area
- every script should have the following line on top"
#+begin_src
#define __CLING__ 1
#+end_src
- because of the complexity of the C++ code, ROOT needs to be restarted every time you reload your script
* ------------------------------------------------------------------------------
* back to [[file:frontends.org][frontends]]
* ------------------------------------------------------------------------------
